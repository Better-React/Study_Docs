# ✔로그인
- session
- jwt
- 쿠키
- oauth
- 페이지 인증
- 유저 정보 관리

## 👀질문
1. 웹 스토리지: 로컬 스토리지, 세션 스토리지 => getitem, setitem, clear, remove(자바스크립트 내에서)   
2. 프로젝트 => 로그인(비밀번호) 암호화
3. jwt 유효기간이 있다 보니까 유효 기간이 만료될 때 까지는 서버에서 토큰을 지우기 힘들다. => 기존 토큰 발급 기간을 줄인다.    
4. baseUrl64의 문제점을 jwt가 그대로 품을 수 밖에 없다.    

## 📂면접 예상 질문
- 세션, jwt, oauth의 장단점을 설명해보세요.
- 로그인 유무, 관리자, 혹은 특정 그룹만 이용 가능한 페이지는 어떻게 관리할까요?
- jwt의 구조와 보안 취약점을 설명해보세요.
- 유저 정보는 어디서 관리하는 것이 좋을까요? 장단점과 함께 설명해보세요.
- 새로고침 하면 로그인 상태에는 어떤 변화가 있나요?
- redux persist와 같은 라이브러리를 사용해 본적이 있나요? 어떤 라이브러리인지 설명하고, 어떤 경우에 쓰는지 설명해보세요.

## 세션
- 어떻게 사용되나요?
1. 클라이언트가 로그인
2. 성공하면 서버가 유저 세션을 만들고 메모리나 데이터베이스에 저장한다.
3. 서버가 클라이언트에게 세션 ID를 보낸다.
4. 클라이언트의 브라우저에 세션의 ID만 쿠키에 저장하게 한다.

- 장점은?   
1. 프론트가 할 일이 적다.
2. 클라이언트에 정보를 저장하는 쿠키보다는 보안이 좋다.

- 단점은?
1. 중앙 세션 관리 시스템이 없으면, 시스템 확장에 어려움이 생긴다.
2. 중앙 세션 관리 시스템이 장애가 일어나면, 시스템 전체가 문제가 생긴다.
3. 만약 메모리에 세션 정보가 들어있다면, 메모리가 많이 사용될 수 있다.


## jwt
- 어떻게 사용되나요?
1. 클라이언트가 로그인을 하면, 서버로부터 access 토큰을 부여받는다.
2. 클라이언트가 모든 api 요청을 할 때 access 토큰을 포함시킨다.
3. 서버는 access 토큰을 해독해 확인하고 검증되면 해당 api 기능을 수행한다.
4. 기한이 만료되었으면 access 토큰을 지워주고 재로그인을 하게 한다.

- 구조는?
  * Header— 토큰 유형. 해시 알고리즘/ Base64Url로 인코딩
  * Payload— 클라이언트 정보. meta Data/ Base64Url로 인코딩
  * <strong>Signature— header에서 지정한 알고리즘. secret 키. 서명</strong>

- 유의점
1. payload는 내용 해독이 가능하므로 중요한 정보를 담지 않는다.
2. 수명을 짧게하고 정기적으로 재발급하면 보안이 좋아진다.

- JWT 어디에 저장할까
  * local/session storage: xss공격에 취약
  * Cookies: csrf 공격에 취약 -> csurf 같은 라이브러리 사용

## 유저 정보는 어디에 저장할까
- localstorage vs sessionStorage vs cookies
- 브라우저 내에 키-값 쌍을 저장
- 새로고침(sessionStorage), 브라우저 다시 실행(localstorage)
- 웹 스토리지 객체는 네트워크 요청 시 서버로 전송되지 않습니다. 
- 많은 자료 보관 가능
- 개발자는 브라우저 내 웹 스토리지 구성 방식을 설정할 수 있습니다.
- HTTP 헤더를 통해 스토리지 객체를 조작할 수 없다는 것입니다.
- 웹 스토리지 객체는 도메인·프로토콜·포트로 정의되는 오리진(origin)에 묶여있습니다. 따라서 프로토콜과 서브 도메인이 다르면 데이터에 접근할 수 없습니다.
- localstorage : 지속 가능, 무조건 문자열
- sessionstorage : 1회성

## 쿠키
- 쿠키 설정 시 모든 웹 요청은 쿠키 정보를 포함하여 서버로 전송된다.
- 하나의 사이트에서 저장할 수 있는 쿠키 갯수가 제한적/ 크기도 제한
- 만료 일자 존재
 
## 언제 어떤 것을 사용할까?
- 팝업창 - cookie
- 자동 로그인 - localstorage
- 입력 폼 정보 - sessionStorage
- 비로그인 장바구니 - sessionStorage
 
## 페이지 인증
- hoc 사용 => redux에서 API 요청으로 사용자 auth 정보를 가지고 온다.
- hoc의 사용 => withAuth 뿐 아니라 특정 dom에 따로 처리가 필요한 경우에 사용 할 수 있다. 하지만 남발하면 코드 디버깅 하기가 어려워진다. 그러나 적절하게 사용하면 코드의 중복을 많은 부분 줄일 수 있다.
- 서버에서 받아온 값으로 isAdmin, isAuth 등을 이용해 사용자 정보, 관리자 페이지를 구분한다.

## ⛏번외
- IndexedDB

