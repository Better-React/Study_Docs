# ✔︎ 이미지 최적화

## <span>1. 이미지의 중요성</span>

> 고품질의 이미지로 브랜드 가치나 상품을 홍보하려 하기 때문에 이미지의 중요성이 더욱 커지고 있다. 

### a. 화소 밀도

- 물리 스크린 공간 안에 얼마나 많은 픽셀이 압축되어 있는가를 의미한다. 
- 1x, 2x 와 같은 기기 픽셀 비율로 표현한다. 
- 모니터나 TV의 화소 밀도는 보통 인칭당 픽셀 개수인 PPI(Pixel Per Inch)로 표현한다. 
  - ex) 1인치(2.54cm)안에 20개의 픽셀이 있으면 20PPI로 표현한다. 
- 같은 1인치 안에 픽셀 수가 많으면 많을수록 화소 밀도가 높고 화소 밀도가 높을수록 더 선명한 화면을 표현할 수 있다. 

### b. 포인트

- 웹 이미지 크기를 얘기할 때 포인트라는 용어를 사용하기도한다. 
  - 40포인트 이미지는 1x 에서는 40픽셀 2x 에서는 80픽셀 3x 에서는 120픽셀


## <span>2. 디지털 이미지의 종류와 특성</span>

> 이미지를 잘 사용하려면 이미지의 종류와 특성을 파악하여 사용될 기기 타입과 용도에 맞춰서 적절한 이미지를 선택해야한다. 

### a. 래스터 이미지 vs 백터 이미지

- <code><b>래스터 이미지</b></code> 
  - 우리가 사용하는 대부분의 이미지 유형이다. 각각의 픽셀들이 모여 하나의 큰 이미지를 만든다.
  - 이로 인해 사이즈가 크거나 품질이 더 좋은 이미지를 만들기 위해서는 그만큼의 정보를 담은 픽셀을 추가해야한다. (확장성 떨어짐)
- <code><b>백터 이미지</b></code>
  - 그리고자 하는 대상의 수학적인 정보를 제공한다. 이미지가 위치할 좌표나 원, 사각형 등 형상, 크기, 색상 정보를 제공하여 컴퓨터 그림을 그리듯 화면에 표현한다. 
  - 메타 정보를 담고 있으므로 화면이 커지거나 작아진다고해서 정보가 달라지지 않는다.
  - 항상 선명한 이미지를 표현할 수 있다. 
  - svg 파일은 텍스트 기반 콘텐츠 이므로 gzip 이나 brotli 같은 덱스트 압축 기법으로 최적화 할 수 있다.
  - zopfli 압축 기법으로 svgz 파일을 만들어서 사용할 수도 있다. 

### b. 무손실 이미지 형식 vs 손실 이미지 형식

- <code><b>무손실 이미지 형식</b></code> 
  - 원본 이미지의 정보 손실을 허용하지 않으면 무손실 이미지이다. 
  - <code><b>GIF</b></code>
    - 가장 처음으로 등장한 이동식 이미지 형식
    - 색상은 256(8bit)컬러로 매우 제한적이다.
    - 화려한 색상의 복잡한 이미지 보다 단순한 형태 이미지 표현에 적합하다.
  - <code><b>PNG</b></code>
    - 256색만 사용할 수 있는 GIF의 단점과 특허 문제를 해결하기 위해 개발 되었다. 
    - 24비트 색상을 사용하므로 GIF보다 고품질 이미지를 표현할 수 있다. 
    - 알파 채널이라 불리는 투명 기능 때문에 PNG가 많이 사용된다. 
    - <code>컬러 팔레트 PNG</code>,  <code>트루 컬러 PNG</code>로 나뉘며 대부분 웹에서 사용되는 PNG는 알파 채널이 추가된 <code>트루 컬러 PNG</code>이다.
    <br />
- <code><b>손실 이미지 형식</b></code>
  - 필요에 따라 이동할 수 있는 형태를 만들기 위해 정보 손실을 어느 정도 허용하면 손실 이미지다. 
  - <code><b>JPEG</b></code>
    - 사진을 저장하는 표준 형식
    - 사람의 눈이 인식할 수 있는 색상만 남기고 나머지를 제거하는 방식의 기술을 이용하여 이미지를 표시하는 데 필요한 정보를 줄여서 고해상도의 이미지를 크게 압축한 파일로 저장할 수 있다. 
    - 압출률이 높아 PNG 파일보다 크기가 작지만 투명 기능이나 애니메이션 기능을 지원하지 않는다. 

  - <code><b>JPEG 2000</b></code>
    - JPEG 압축 방식과 다르게 새로운 방식을 사용하여 이미지 압축률을 높혔다. 
    - 무손실 압축 및 투명 기능, 애니메이션 기능을 지원한다.
    - 16, 24, 32 비트 등 다양한 색상을 지원한다. 
    - 많은 기능이 포함된 만큼 더 많은 프로세싱 자원이 필요하다. 
    - iOS용 크롬, 사파리 계열 브라우저에서만 지원함.

  - <code><b>WebP</b></code>
    - 구글에서 개발하고 배포한 이미지 형식이다.
    - JPEG보다 개선된 압축 방식을 사용하여 파일 크기를 25-35% 정도 작게 만들었다. 
      - 이미지 품질을 많이 낮춰서 화질에 손실이 발생한다. 
    - 무손실 압축, 애니메이션 기능, 투명 기능 모두 지원한다.
    - JPEG가 가진 점진적 데이터 전송 기능은 갖추지 못했다. 

  - <code><b>JPEG XR</b></code>
    - MS사가 개발한 이미지 형식이다.
    - 색상 다양하게 표현 가능하다.
    - 무손실 압축, 투명 기능 지원
    - 점진적 데이터 전송 가능
    - 향상된 압축 기법으로 파일 크기를 크게 감소 시킬 수 있음
    - 인터넷 익스플로어, 엣지 에서만 지원

## <span>3. 이미지 변환 기법</span>

### a. 무손실 압축

- 각 이미지 유형을 다르게 처리해야한다.
- 스크립트를 통해 압축을 자동화 할 수 있다.
  - <code><b>GIF</b></code>
    - <code>ImageMagicK</code>
    - <code>Giflossy</code>
    - <code>Gifsicle</code>
    - <code>gif2webp converter</code>

  - <code><b>PNG</b></code>
    - PNG 임을 알리는 구부자인 첫 8바이트의 서명을 제외하고 청크 형태로 이미지를 정보를 저장한다. 필요없는 청크들은 웹 렌더링에 필요하지 않으므로 삭제할 수 있다.
    - <code>Pngcrush</code>
    - <code>Pngquant</code>

  - <code><b>JPEG</b></code>
    - 메타 데이터가 포함되어 있다.
      - 주석 및 공백
      - 편집 어플리케이션 정보
      - 카메라 제조사, 모델, 촬영 날짜, 위치 정보 등
    - 위와 같은 메타데이터를 제거한다.
    - <code>MozJPEG</code>
    - <code>Guetzli</code>

### b. 손실 압축

- 특정 이미지 정보를 누락, 즉 손실시켜 파일 크기를 줄이는 방법이다. 
- 85-80% 정도 품질의 이미지 손실 압축을 권장한다.
  - 열화 없이 변환됨
- <code>ImageMagicK가 지원함</code>

## <span>4. 반응형 웹에서의 이미지 배치전략</span>
### a. 모바일 사이트(엠닷 사이트)의 문제점

  - 모바일 기기의 크기가 다양해지면서 엠닷 사이트 하나만으로 모든 기기의 사용자들을 만족 시킬 수 없다.
  - 데스크톱용 사이트와 모바일 사이트를 동시에 개발하고 관리 해야하므로 유지보수의 문제점이 있다. 
  - 모바일 사이트의 유지 보수가 어려워짐에 따라 모바일 사이트에는 몇 가지 중요한 기능들이 누락 되어 있고 UI / UX도 달라져 사용자들이 불편함을 겪고 모바일 기기에서도 데스크톱과 동일한 사용성을 요구하고 있다. 

### b. 반응형 웹의 등장
  - 반응형 웹을 사용하면 기기별로 웹 사이트를 구축하지 않아도 되므로 유지 보수의 필요성이 없어짐
  - 모바일  사용자의 사용성도 개선되고 SEO 측면에서도 큰 이점을 제공한다. 

### c. 반응형 웹의 문제점
  - 데스크톱과 모바일 기기에서 동일한 사용자 경험을 제공하지만 성능에서는 효과적이지 않았다. 
  - 화면 크기에 따라 페이지 무게가 달라지는 것이 아닌 네트워크 유형에 따라 처리량과 시간이 달라짐
  - 즉, 데스크톱에 비해 모바일 기기의 GPU, 메모리 등의 사양이 좋지 않아 모바일 환경에서 페이지 로딩 시간은 더욱 길어지고 사용자 경험의 질을 저하 시킨다.
    -> 하지만 요즘은 모바일 기기의 사양이 좋아져서 괜찮을듯!

# Reference
- https://imagemagick.org/index.php

jpg, png, pdf의 3종류 이미지 압축이 가능.
- https://compressjpeg.com/ko/
 jpg, png의 2종류 이미지 압축이 가능.
- https://tinypng.com/

